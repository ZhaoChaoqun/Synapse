# InsightSentinel (洞察哨兵) - 产品需求文档

## 文档信息
- **版本**: v1.0
- **创建日期**: 2026-02-06
- **最后更新**: 2026-02-06
- **作者**: Synapse Team

---

## 变更历史

| 版本 | 日期 | 变更内容 | 作者 |
|------|------|---------|------|
| v1.0 | 2026-02-06 | 初始版本，定义核心功能和 MVP 范围 | Synapse Team |

---

## 1. 产品概述

### 1.1 产品愿景
**InsightSentinel（洞察哨兵）** 是一个 7x24 小时运行的自主智能体，通过"多步推理"发现竞争对手隐藏的战略意图或行业趋势，专注于 GCR（大中华区）AI 市场。

### 1.2 目标用户
- **产品经理**: 需要追踪竞品动态和行业趋势
- **创始人/CEO**: 需要战略层面的市场情报
- **投资人**: 需要了解 AI 赛道公司动态
- **研究分析师**: 需要深度行业研报支持

### 1.3 核心价值主张
1. **自主性**: Agent 不仅搬运信息，还能自主决策搜索方向
2. **深度**: 跨平台交叉验证，发现隐藏的关联
3. **时效性**: 7x24 实时监控，第一时间发现变化
4. **可信度**: 标注信息来源可靠性，区分官方公关稿与真实反馈

---

## 2. 核心功能

### 2.1 Agentic Loop 多步推理

#### 功能描述
Agent 接收用户命令后，自主完成 3-5 步任务，展示完整的思考链路。

#### 用户故事
> 作为产品经理，我希望输入"调研 DeepSeek 最新动态"后，Agent 能自动：
> 1. 搜索各平台的 DeepSeek 相关内容
> 2. 发现新关键词（如"DeepSeek R1"）并自主追加搜索
> 3. 交叉验证信息可信度
> 4. 生成结构化情报报告

#### 关键行为
- **任务拆解 (Decomposition)**: 将复杂任务分解为子任务
- **自主搜索 (Recursive Search)**: 发现新关键词时自主决定是否追加
- **批判性评估 (Critical Review)**: 交叉验证，标注可信度

#### 前端展示
- 左侧 LogPanel 实时展示 Agent 的"思考链路"
- 每一步显示：时间戳、动作、观察结果
- 进度条显示任务完成度

### 2.2 GCR 平台数据抓取

#### 功能描述
接入中国主流社交媒体平台，抓取真实数据。

#### 支持平台
| 平台 | 数据类型 | 价值侧重 |
|------|---------|---------|
| 微信公众号 | 长文分析 | 战略分析、深度报告 |
| 知乎 | 专业问答 | 技术深度、专业辩论 |
| 小红书 | 图文笔记 | 用户体验、产品反馈 |
| 抖音 | 短视频 | 大众认知、传播趋势 |

#### 关键能力
- **反爬处理**: 代理池、指纹伪装、速率控制
- **内容解析**: 提取标题、正文、作者、时间、互动数据
- **去重合并**: 识别跨平台重复内容

### 2.3 错误自愈能力

#### 功能描述
当 API 调用失败或爬虫被封时，Agent 自主调整策略并重试。

#### 恢复策略
| 错误类型 | 恢复策略 |
|---------|---------|
| API 限流 | 指数退避重试 |
| 爬虫被封 | 切换代理 / 降级缓存 |
| 网络超时 | 自动重试 |
| 验证码 | 切换代理 + 告警 |

#### 前端展示
- LogPanel 显示恢复过程：`[ALERT] 遇到错误: 403 Forbidden，正在切换代理...`
- 展示 Agent 的"智能"：不是简单重试，而是策略调整

### 2.4 长效记忆系统

#### 功能描述
存储历史情报，支持语义搜索和跨时间洞察。

#### 核心能力
- **语义搜索**: 基于向量相似度检索相关情报
- **时间轴记忆**: 检测状态变化（如"3个月前下线的功能现在又上线了"）
- **实体关联**: 追踪公司、产品、人物之间的关系

#### 数据存储
- **PostgreSQL**: 结构化数据（竞品信息、任务记录）
- **pgvector/Qdrant**: 向量嵌入（语义搜索）

---

## 3. 用户界面

### 3.1 Mission Control Dashboard（主控制台）

#### 布局
```
┌─────────────────────────────────────────────────────────────┐
│  [Header] InsightSentinel - GCR Market Monitor        [用户] │
├───────────┬─────────────────────────────────────────────────┤
│           │  ┌───────┬───────┬───────┬───────┐              │
│  Live     │  │微信   │知乎   │小红书 │抖音   │ ← GCR 热度卡片│
│  Reasoning│  │Pulse  │Heat   │Trend  │Vel    │              │
│  Feed     │  └───────┴───────┴───────┴───────┘              │
│           │                                                  │
│  (Agent   │  ┌─────────────────────────────────┐            │
│  思考链路) │  │      Intelligence Network       │ ← 知识图谱  │
│           │  │      (DeepSeek ─ Moonshot)      │            │
│           │  └─────────────────────────────────┘            │
├───────────┴─────────────────────────────────────────────────┤
│  [Command Bar] Monitor DeepSeek's latest...        [Execute] │
└─────────────────────────────────────────────────────────────┘
```

#### 组件说明
1. **Header**: 品牌标识、系统状态、性能指标
2. **Live Reasoning Feed**: 实时展示 Agent 思考过程
3. **GCR Platform Cards**: 四大平台热度统计
4. **Intelligence Network**: 知识图谱可视化
5. **Command Bar**: 用户输入命令

### 3.2 Deep Dive Investigation View（深度调查视图）

用于展示单个主题的深度调研结果：
- 推理逻辑时间线
- 来源可追溯性（点击查看原文）
- 机会/威胁评分

### 3.3 Cross-Platform Insight Gallery（跨平台情报库）

按平台分类展示情报卡片：
- 微信卡片：突出战略分析
- 知乎卡片：突出技术深度
- 小红书卡片：突出用户情绪
- 抖音卡片：突出传播趋势

---

## 4. 技术需求

### 4.1 性能指标
| 指标 | 目标值 |
|------|-------|
| 命令响应时间 | < 2秒开始流式响应 |
| 单次调研完成时间 | < 60秒 |
| 爬虫成功率 | > 90% |
| 系统可用性 | 99.9% |

### 4.2 安全需求
- API Key 加密存储
- 爬虫行为合规（遵守 robots.txt）
- 用户数据隔离

---

## 5. MVP 范围

### 5.1 MVP 功能 (Hackathon Demo)
- [x] 前端 Dashboard UI（已完成）
- [ ] 后端 FastAPI 服务
- [ ] Agentic Loop 核心（Planner + Executor）
- [ ] 至少 2 个平台爬虫（知乎 + 微信）
- [ ] SSE 实时推送思考链路
- [ ] 基础错误自愈（指数退避 + 代理切换）
- [ ] 向量存储基础功能

### 5.2 未来迭代
- 完整 4 平台爬虫
- 高级 Critic 批判性评估
- 时间轴变化检测
- 邮件/Webhook 通知
- 多用户支持

---

## 6. 演示场景

### 6.1 主演示流程
```
1. 用户输入: "Monitor DeepSeek's latest developments"
2. Agent 开始任务拆解，LogPanel 实时显示思考
3. Agent 搜索知乎、微信，发现"DeepSeek R1"新关键词
4. Agent 自主决定追加搜索
5. Agent 进行批判性评估，标注可信度
6. 生成情报摘要，更新 Dashboard
```

### 6.2 错误自愈演示
```
1. 故意触发爬虫被封 (403)
2. LogPanel 显示: "[ALERT] 检测到访问受限，切换代理中..."
3. Agent 自动恢复，继续任务
4. LogPanel 显示: "[INFO] 代理切换成功，继续搜索..."
```

---

## 附录

### A. 竞品分析
- **Perplexity**: 搜索+对话，但不支持 GCR 平台
- **Grok**: 实时推特数据，但不支持深度调研
- **国内 AI 搜索**: 被动搜索，无自主 Agent 能力

### B. 技术参考
- Google Gemini API
- FastAPI 框架
- pgvector 向量扩展
- Playwright 浏览器自动化
